@model BestellingCreateViewModel
@{
    ViewData["Title"] = "Nieuwe Bestelling";
}

<h2>Nieuwe Bestelling</h2>

@if (!Model.HasAssignedTable)
{
    <div class="alert alert-warning">
        U heeft nog geen tafel toegewezen. <strong>Check eerst in bij de zaalverantwoordelijke.</strong>
    </div>
}
else
{
    <form asp-action="Create" method="post">
        <input type="hidden" asp-for="ReservatieId" />

        <h4>Menuoverzicht</h4>
        @foreach (var categorie in Model.MenuOverzicht)
        {
            <div class="mb-3">
                <h5>@categorie.Naam</h5>
                <ul class="list-group">
                    @foreach (var product in categorie.Producten)
                    {
                        <li class="list-group-item d-flex justify-content-between align-items-center">
                            <span>
                                <strong>@product.Naam</strong> - @product.Beschrijving
                                <br />
                                <small>Prijs: @product.Prijs.ToString("C")</small>
                            </span>
                            <input type="number" min="0" value="0" name="SelectedItems[@product.Id]" class="form-control w-25" />
                        </li>
                    }
                </ul>
            </div>
        }

        <h4>Winkelmandje</h4>
        @if (Model.CartItems.Any())
        {
            <table class="table">
                <thead>
                    <tr>
                        <th>Product</th>
                        <th>Aantal</th>
                        <th>Prijs</th>
                        <th>Totaal</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var item in Model.CartItems)
                    {
                        <tr>
                            <td>@item.Product.Naam</td>
                            <td>@item.Aantal</td>
                            <td>@item.Product.Prijs.ToString("C")</td>
                            <td>@(item.Aantal * item.Product.Prijs).ToString("C")</td>
                        </tr>
                    }
                </tbody>
            </table>
            <div class="fw-bold">Totaalbedrag: @Model.TotaalBedrag.ToString("C")</div>
        }
        else
        {
            <div class="text-muted">Uw winkelmandje is leeg.</div>
        }

        <button type="submit" class="btn btn-primary mt-3">Bestelling bevestigen</button>
    </form>
}

@if (Model.NetworkError)
{
    <div class="alert alert-danger mt-3">
        Netwerkprobleem: uw bestelling is als concept opgeslagen. Probeer later opnieuw te bevestigen.
    </div>
}
